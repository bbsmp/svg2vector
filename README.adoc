
:release-version: 2.1.0-SNAPSHOT
:java: 8
= SVG2Vector
v{release-version}
:page-layout: base
:toc: preamble



[%autowidth, frame=none, grid=none, cols="a,a,a,a,a"]
|===

|[link=https://search.maven.org/#search\|gav\|1\|g%3A%22de.vandermeer%22%20AND%20a%3A%22svg2vector%22]
image::https://img.shields.io/maven-central/v/de.vandermeer/svg2vector.svg[Maven Central]
|[link=https://github.com/vdmeer/svg2vector]
image::https://img.shields.io/github/tag/vdmeer/svg2vector.svg[GitHub Tags]
|image::https://img.shields.io/badge/license-Apache_2.0-blue.svg[License]
|image::https://img.shields.io/badge/java-Java_{java}+-blue.svg[License]
|image::https://img.shields.io/github/issues/vdmeer/svg2vector.svg[test]

|===


//|[link=http://www.vandermeer.de/projects/skb/java/svg2vector/]
//image::https://img.shields.io/website/http/www.vandermeer.de/projects/skb/java/svg2vector/index.html.svg[Website]


//[![Maven Central](https://maven-badges.herokuapp.com/maven-central/org.apache.commons/commons-lang3/badge.svg)](https://maven-badges.herokuapp.com/maven-central/org.apache.commons/commons-lang3/)


//[![License](https://img.shields.io/badge/license-Apache2-blue.svg)]



A simple tool box to convert SVG graphics to other vector formats, such as EMF and PDF. 


== Resources


[frame=topbot, grid=rows, cols="d,d"]
|===

| Home page
| http://www.vandermeer.de/projects/skb/java/svg2vector[site]

| Binaries current release
| https://bintray.com/vdmeer/generic/svg2vector/{release-version}[Bintray current release {release-version}]

| Binaries all releases
| https://bintray.com/vdmeer/generic/svg2vector[Bintray all releases]

| Source repository
| https://github.com/vdmeer/svg2vector/tree/master[Github]

| Maven Central current release
| https://search.maven.org/#artifactdetails\|de.vandermeer\|svg2vector\|{release-version}\|jar[Maven current release {release-version}]

| Maven Central all releases
| https://search.maven.org/#search\|gav\|1\|g%3A%22de.vandermeer%22%20AND%20a%3A%22svg2vector%22[Maven all releases]

|===


== Concepts

The main concepts are: application, input, and target.


=== Application

The SVG2Vector tool provides different applications to convert SVG graphics to target formats.
The tool uses the SKB ExecS to launch applications.
All applications are registered with the Java class `Svg2VectorExecs` for easy execution.
Once an application is selected for execution, the application specific command line options and processing applies.

Currently supported are:

* `s2v-hp` - converting SVG graphics to vector formats using Apache Batik and Freehep libraries
* `s2v-is` - converting SVG graphics to vector (and selected bitmap) formats using an existing Inkscape executable
* `s2v-aec` - prints all used error codes with descriptions to standard out

Some standard applications from the ExecS package are also available when using the standard executor:

* gen-configure - used to configure generated runtime scripts for the application
* gen-exec-jar-scripts - creates operating system specific start scripts when using the all-in-one executable jar artifact
* gen-run-scripts - creates run scripts for application installation


=== Input

The input for each application needs to be a valid SVG file.
There are several options for a valid SVG file:

* Plain SVG as plain text file
* Plain SVG as GZ compressed file
* Inkscape SVG as plain text file
* Inkscape SVG as GZ compressed file

Other SVG variations might work as well, but have not been tested.


=== Target

The target of a conversion defines the target format and helps to select a target converter.
The target implicitely defines the target file extension.
The target also allows to identify target-specific conversion options, for instance the PS level for a PS or EPS target.

The application `s2v-fh` is using Apache Batik for SVG document handling and FreeHep libraries for conversion.
This means that specific name spaces from an Inkscape SVG are not processed (largely ignored).
The Inkscape Wiki has a page explaining the specific name spaces `inkscape` and `sodipodi`: http://wiki.inkscape.org/wiki/index.php/Inkscape_SVG_vs._plain_SVG .

In case the input is generated from Inkscape and `s2v-fh` has to be used for the conversion, the best practice is to safe the file as `Plain SVG` with Inkscape.
Otherwise, several formatting descriptions (e.g. centered text) will not be converted correctly.

If an Inkscape installation is available, then `s2v-is` can be used. This will convert all standard targets (such as PDF and PNG) correctly using Inkscape.
For EMF conversion, manual layer handling and temporary file creation should be used.


=== Return codes and errors
The conversion applications will print error messages (if not switched off) and also return an integer.
Those codes can be used by a calling application to understand potential errors in the excution of a conversion application.

There are three different types of return codes:

* 0 - the execution was successfull, all steps have been passed, output should have been created as requested
* 1 (or other positive integer) - the application found an _early_ exit option, such as help, version, or usage.
* any negative integer: an error has occurred, error message printed to standard error (if not switched off)

The negative return codes are error codes. Each error has a specific code.
All error codes are handled by an enumerat.
Use the application `s2v-aec` to print all error codes.

== Features

Tool box with applications to convert SVG graphivs to other vector formats and some bitmap formats.

=== Standard Features
Standard features are available in all applications.
They cover configuration for conversion targets, message handling, input file, names for outoput file(s) and directories, Inkscape layer handline, and other general options.
In addition, the applications are using the ExecS package and thus providing help and version information via command line as well.

==== Help and version
* general help (usage)
* detailed help for each command line options
* version information

==== Input options
* read file either as plain text file or as GZIP (`.gz`) file
* can process plain SVG or Inkscape SVg files (latter required for layers)

==== Target
* set conversion target
* set text-as-shape conversion option

==== Message handling
* set application to quiet mode
* set application to verbose mode
* activate warnings, process information, and detailed messages
* deactivate error messages

==== Output handling
* automatically create directories
* overwrite existing output files
* keep temporarily created artifacts (files and directories)

==== Output name handling
* set output file and/or directory
* set basename for output files
* deactivate use of basename for output files

==== Layer handling
* process Inkscape layers found in input files
* process layers if they exist
* several options for the output file names when using layers
* switch all layers on for single conversion

==== Other features
* simulate conversion, i.e. run but only print messages, do not create any output


=== s2v-fp features
Converts SVG to vector formats using Apache Batik to load an SVG document and the Freehep libraries for the conversion.
Supported target formats are: EMF, PDF, plain SVG (no Inkscape name space).
Each target allows to configure:

* switch on background
* background color
* switch off transparancy
* use cliping


=== s2v-is features
Converts SVG to vector formats and some bitmap formats using an existing Inkscape installation.
Supported target formats are: EMF, PDF, EPS, PS, WMF, plain SVG (no Inkscape name space), and PNG.
Other supported options are:

* set Inkscape executable
* create temporary SVG files first (as plain SVG or as Inkscape SVG)
* manual (for optimized EMF generation) or Inkscape object selection handling of layers
* target specific options as upported by Inkscape:
  ** for PDF: set PDF version
  ** for PS: set PS level
  ** for PNG: set output DPI


== Installation
Requirements:

* Java 8 runtime to run the applications
* Maven or other build system if build from source
* CygWin or UNIX to install application from ZIP


=== In your build system

==== Maven

For Maven declare a dependency in the `<dependencies>` section of your POM file.

[source,xml,subs=attributes+]
.Dependency declaration in pom.xml
----
<dependency>
    <groupId>de.vandermeer</groupId>
    <artifactId>svg2vector</artifactId>
    <version>{release-version}</version>
</dependency>
----


==== Gradle / Grails

[source,sh,subs=attributes+]
----
compile 'de.vandermeer:svg2vector:{release-version}'
----


==== Other build systems

For other build systems see https://search.maven.org/#artifactdetails\|de.vandermeer\|svg2vector\|{release-version}\|jar[Maven Central]


=== As a stand-alone application
The stand-alone application can be installed in UNIX and CygWin systems.
The installation will create all required scripts to run the applications
On CygWin, the installation will also create DOS/Windows batch files to start the applications.

* download the ZIP archive from BinTray: https://bintray.com/vdmeer/generic/svg2vector/{release-version}[{release-version}].
* unzip in a directory of your choice

Now you can run the script generation:
----
cd bin
./init.sh
----

The script `init.sh` will create scripts to run the tool for Unix (`bin/sh`) and if you run `init.sh` on a CygWin system also for CygWin (`bin/cyg`) and DOS/Windows (`bin/bat`).
Now simple run the script `sh/s2v-hp.sh` (assuming you are on a Unix system).


=== Using the executable JAR

* download the executable JAR file from BinTray: https://bintray.com/vdmeer/generic/svg2vector/{release-version}[{release-version}].
* move the JAR to a directory on your system

Now you can run the following command to create scripts executing the applications:

[source,sh,subs=attributes+]
----
java -jar svg2vector-{release-version}-jar-with-dependencies.jar gen-exec-jar-scripts
----

This will create scripts, which you can then move into a binary directory of your system.

You can manually run the executable JAR file as well.
The main class of the JAR is set to an ExecS execution service.
Simply running the jar will produce a help screen from ExecS.
Using `-l` shows all registered applications, including `s2v-fh` and `s2v-is`.
Direcly running the conversion applications as follows

[source,sh,subs=attributes+]
----
java -jar svg2vector-{release-version}-jar-with-dependencies.jar s2v-fh
----

[source,sh,subs=attributes+]
----
java -jar svg2vector-{release-version}-jar-with-dependencies.jar s2v-is
----


=== Build and install from source
One can also clone the repository, build it, and then use the created application artifacts.
Clone and build the repo:

[source,sh,subs=attributes+]
----
git clone https://github.com/vdmeer/svg2vector.git
cd svg2vector
mvn package
----

This will create a folder target with all build artifacts.
In the target folder, one can find application artifacts to run the tool.

[source,sh,subs=attributes+]
----
cd target/application
ls -l
----

The artifacts there are (substitute X/Y/Z with the version you cloned/built)

* svg2vector-{release-version}-application.tar.gz
* svg2vector-{release-version}-application.zip
* svg2vector-{release-version}-jar-with-dependencies.jar

Now use either of the two archives and install the stand-alone application or the executable JAR.


== Short User Guide


=== Using applications from command line

After installation, simply run an application with command line (CLI) options.
Input file and target are always required.
Some applications have other required CLI options.

Running an application without any option will produce either an error stating which options are required or do nothing.
For instance, running `s2v-fh` without any options:

[source, bash]
----------------------------------------------------------------------------------------
#s2v-fh
s2v-fh: error parsing command line -> Missing required options: t, f

----------------------------------------------------------------------------------------


Use `--help` for general usage information and `--help [option]` for detailed help information on a particular option.
For instance, running `s2v-is` with `--help target` will provide detailed information on the CLI option target:

----------------------------------------------------------------------------------------
#s2v-is --help target
CLI option:  -t, --target <TARGET> (required)  -  specifies a conversion target
Description:
target for the conversion Supported targets are: svg, pdf, emf, wmf, ps, eps, png

----------------------------------------------------------------------------------------

Assuming there is an input file `time-interval-based.svgz` in the directory `src/test/resources/svg-files`, a conversion with layer handling into the output folder `target/output-tests/s2v-fh/pdf/layers-index` with simple progress information can be realised as follows:

[source, bash]
----------------------------------------------------------------------------------------
# s2v-fh --create-directories --overwrite-existing -l -i -t pdf -f src/test/resources/svg-files/time-interval-based.svgz -d target/output-tests/s2v-fh/pdf/layers-index -p
s2v-fh: --- processing multi layer, multi file output
s2v-fh: --- creating directories for output
s2v-fh: --- processing layer 00-frame
s2v-fh: --- processing layer 06-xEy
s2v-fh: --- processing layer 01-table
s2v-fh: --- processing layer 10-xSy
s2v-fh: --- processing layer 11-xFy
s2v-fh: --- processing layer 08-xOy
s2v-fh: --- processing layer 07-xMy
s2v-fh: --- processing layer 09-xDy
s2v-fh: --- processing layer 05-xBy
s2v-fh: --- finished successfully

----------------------------------------------------------------------------------------




=== Using applications in Java

The applications can be used in Java by simply creating a `String[]` with the commands (same as command line) and then calling the execution method `executeApplication(...)`directly.
The following code shows an example creating and object for the `s2v-fh` application, with a set of command line options, and then executing it.

[source, java, linenums]
----------------------------------------------------------------------------------------
String[] args = new String[]{
	"--create-directories", "--overwrite-existing",
	"--all-layers", "-l", "-i",
	"-t", "pdf",
	"-f", "src/test/resources/svg-files/time-interval-based.svgz",
	"-d", "target/output-tests/s2v-fh/pdf/layers-index",
	"-q"
};
Svg2Vector_FH app = new Svg2Vector_FH();
app.executeApplication(args);
----------------------------------------------------------------------------------------

The applications use return codes to provide information about the execution status:

* `0` means successfull execution
* `>0` means an early exit option (such as `--help` or `--version`) was used
* `<0` means an error did occur


== Command Line Interface

=== Standard CLI options

[frame=topbot, grid=rows, cols="1,3,6", options="header"]
|===

| Short
| Long
| Description

|-?
|--help <ARG>
|application and argument help

|
|--all-layers
|switch on all layers

|-B
|--fout-islabel
|use Inkscape label in output file names

|
|--create-directories
|automatically create directories for output

|-d
|--output-directory <DIR>
|output directory

|-e
|--print-details
|print detailed information to stdout

|-f
|--input-file <FILE>
|input filename

|
|--fout-no-basename
|when processing layers, do not use a basename for output files

|-I
|--fout-isindex
|use the Inkscape layer index in output file name

|-i
|--fout-index
|use a continuous index in output file name

|
|--keep-tmp-artifacts
|keep temporary created artifacts (files and directories)

|-l
|--layers
|process layers, create one file per layer

|-L
|--layers-if-exist
|process layers if if input file has layers, create one file per layer

|
|--no-errors
|switch off error messages

|-o
|--output-file <FILE>
|output filename

|
|--overwrite-existing
|overwrite existing files on output

|-p
|--print-progress
|print progress information to stdout

|
|--print-stack-trace
|sets a flag to print the stack trace of exceptions

|-q
|--quiet
|puts the application in quiet mode, no progres or error messages will be printed

|-S
|--simulate
|simulate application, no file output

|-s
|--text-as-shape
|text as shape

|-t
|--target <TARGET>
|specifies a target, for instance for a compilation

|
|--use-basename <BASENAME>
|use specified base name for output

|-v
|--verbose
|verbose mode for application

|
|--version
|application version

|-w
|--print-warnings
|print warning messages to stdout

|===



=== s2v-fp specific CLI options

[frame=topbot, grid=rows, cols="1,3,6", options="header"]
|===

| Short
| Long
| Description


|
|--export-dpi <DPI>
|set DPI for export

|
|--export-pdf-version <VERSION>
|set PDf version for export

|
|--export-ps-level <LEVEL>
|sets the PS level for export (2 or 3)

|-g
|--svg-first
|convert to SVG first, then to actual

|-m
|--manual-layers
|manage layers manually when creating

|-x
|--is-exec <PATH>
|path to Inkscape executable



|===


=== s2v-is specific CLI options

[frame=topbot, grid=rows, cols="1,3,6", options="header"]
|===

| Short
| Long
| Description

|-b
|--no-background
|no background

|-c
|--clip
|clip

|-n
|--not-transparent
|not transparent

|-r
|--bgrnd-color <COLOR>
|background color

|===


=== CLI error codes


== Error codes

=== General Errors (-1 to -49)

[frame=topbot, grid=rows, cols="1,4,4", options="header"]
|===

| Code
| Description
| Error Message

|-2
|General code for a null pointer exception.
|"a null pointer exception occurred"

|-3
|General code for an I/O exception.
|"an I/O pointer exception occurred"

|-4
|An internal implementation error, something wrong with property settings.
|"implementation error: something wrong with property settings"

|===



=== Input File Errors (-100 to -199)

[frame=topbot, grid=rows, cols="1,4,4", options="header"]
|===

| Code
| Description
| Error Message

|-100
|No input file given, was either null or blank.
|"no input file given"

|-101
|Input file does not exist (file name).
|"input file <{}> does not exist, please check path and filename"

|-102
|Input file does exist but is not a file (file name).
|"input file <{}> is not a file, please check path and filename"

|-103
|Input file does exist but is not readable (file name).
|"cannot read input file <{}>, please file permissions"

|===



=== Apache Batik Loader Errors (-210 to -219)

[frame=topbot, grid=rows, cols="1,4,4", options="header"]
|===

| Code
| Description
| Error Message

|-210
|A loader using Apache Batik could not load an SVG document (loaders class, original exception message).
|"{}: exception loading svgDocument: {}"

|-211
|A loader using Apache Batik could set the size for an SVG document, set the dimension (loaders class, original exception message).
|"{}: exception setting docucment size: {}"

|===



=== Inkscape Loader Errors (-220 to -229)

[frame=topbot, grid=rows, cols="1,4,4", options="header"]
|===

| Code
| Description
| Error Message

|-220
|A loader could not open an SVG file as compressed SVG (loader class, input file, original exception message).
|"{}: ZIP exception reading file <{}>: {}"

|-221
|A loader did catch an I/O exception while reading a GZIP stream (loader class, input file, original exception message).
|"{}: IO error reading GZIP file <{}>: {}"

|-222
|A loader did catch a file-not-found exception while reading a plain SVG file (loader class, input file, original exception message).
|"{}: FileNotFoundException exception reading plain file {}: {}"

|-223
|A loader did catch an I/O exception while reading a plain SVG file (loader class, input file, original exception message).
|"{}: IO exception reading plain file {}: {}"

|===



=== Layer Errors (-300 to -319)

[frame=topbot, grid=rows, cols="1,4,4", options="header"]
|===

| Code
| Description
| Error Message

|-300
|An application was requested to process layers, but the input SVG file did not had any.
|"layers requested in command line, but SVG input file has not layers"

|===



=== General Output Errors (-400 to -419)

[frame=topbot, grid=rows, cols="1,4,4", options="header"]
|===

| Code
| Description
| Error Message

|-400
|An implementation error processing output options for a no-layer process: with illegal arguments.
|"implementation error: output for no-layers with illegal arguments"

|===



=== Output File Errors (-420 to -439)

[frame=topbot, grid=rows, cols="1,4,4", options="header"]
|===

| Code
| Description
| Error Message

|-420
|A required output file name is blank.
|"output filename is blank"

|-422
|An output file name is the same as the input file name (output file name, input file name).
|"output <{}> same as input <{}>"

|-423
|The output file name points to a directory (file name).
|"output file <{}> exists but is a directory"

|-424
|The output file exists but no overwrite option given in CLI (file name, required CLI option).
|"output file <{}> exists and no option {} used"

|-425
|Output file exists but no permission (on file system) to write (file name).
|"output file <{}> exists but cannot write to it, please check permissions"

|===



=== Output Directoy Errors (-440 to -459)

[frame=topbot, grid=rows, cols="1,4,4", options="header"]
|===

| Code
| Description
| Error Message

|-440
|An output directory does not exist and no CLI option given to create directories (directory, requried CLI option).
|"output directory <{}> does not exist and CLI option {} not used"

|-441
|An output directory exists but is not a directory (output directory).
|"output directory <{}> exists but is not a directory"

|-442
|An output directory exists no permissions (on file system) to write to it (output directory).
|"output directory <{}> exists but cannot write to it, please check permissions"

|-443
|An output directory may contain target files and no overwrite option given in CLI
|"output directory <{}> may contain target files for extension <{}> and no overwrite in CLI"

|===



=== Output Pattern Errors (-460 to -469)

[frame=topbot, grid=rows, cols="1,4,4", options="header"]
|===

| Code
| Description
| Error Message

|-460
|The output pattern configuration resulted in a path only containing a file extension. This can happen for instance when processing layers, not using a base name, and not using any other fout options (such as indexes and labels). Check those options.
|"output pattern <{}> only contains file extension, check options for generating fnout"

|-461
|The output pattern configuration resulted in a path only containing a directory and a file extension. This can happen for instance when processing layers, not using a base name, and not using any other fout options (such as indexes and labels). Check those options.
|"output pattern <{}> only contains directory and file extension, check options for generating fnout"

|===



=== General Errors (-50 to -99)

[frame=topbot, grid=rows, cols="1,4,4", options="header"]
|===

| Code
| Description
| Error Message

|-50
|A given target was blank, null or empty (arguments: supported targets).
|"given target is blank. Use one of the supported targets: {}"

|-51
|A given target is unknown (arguments: target, supported targets).
|"given target <{}> is unknown. Use one of the supported targets: {}"

|-52
|A given target is not supported by an application (arguments: target, supported targets).
|"given target <{}> not supported. Use one of the supported targets: {}"

|===



=== Inkscape Executor Errors (file name) (-500 to -509)

[frame=topbot, grid=rows, cols="1,4,4", options="header"]
|===

| Code
| Description
| Error Message

|-500
|The given executable for Inkscape was blank (Inkscape executable).
|"expected Inkscape executable, found <{}>"

|-501
|The given executable for Inkscape does not exist (Inkscape executable).
|"Inkscape executable <{}> does not exist, please check path and filename"

|-503
|The given executable for Inkscape is not a file (Inkscape executable).
|"Inkscape executable <{}> is not a file, please check path and filename"

|-504
|The given executable for Inkscape cannot be executed (Inkscape executable).
|"cannot execute input Inkscape executable <{}>, please file permissions"

|===



=== Inkscape Executor Errors (execution) (-510 to -519)

[frame=topbot, grid=rows, cols="1,4,4", options="header"]
|===

| Code
| Description
| Error Message

|-510
|An Inkscape executor did catch an I/O exception during execution (original exception message).
|"IO exception while executing Inkscape with error: {}"

|-511
|An Inkscape executor did get interrupted during execution (original exception message).
|"InterruptedException exception while executing Inkscape with error: {}"

|===



